<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Chapter Interactive Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        #quiz-container {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 flex items-center justify-center min-h-screen p-4">

    <div id="quiz-container" class="w-full max-w-3xl bg-white dark:bg-gray-800 shadow-2xl rounded-xl p-6 md:p-8 transform transition-all duration-500">
        
        <!-- Chapter Selection Screen -->
        <div id="chapter-selection-screen" class="text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-indigo-600 dark:text-indigo-400 mb-4">Strategic Management Quiz</h1>
            <p class="text-gray-600 dark:text-gray-300 mb-8">Please select a chapter to begin the quiz.</p>
            <div id="chapter-buttons-container" class="space-y-3">
                <!-- Chapter buttons will be dynamically inserted here -->
            </div>
        </div>

        <!-- Quiz Screen (Initially hidden) -->
        <div id="quiz-screen" class="hidden">
            <button id="back-to-chapters-btn" class="mb-4 text-sm text-indigo-600 dark:text-indigo-400 hover:underline">&larr; Back to Chapters</button>
            <div id="header-container" class="text-center mb-6 p-4 bg-indigo-50 dark:bg-gray-700 rounded-lg">
                <h2 id="topic-title" class="text-xl font-bold text-indigo-700 dark:text-indigo-300">Topic</h2>
            </div>
            
            <div class="mb-4">
                <div class="flex justify-between items-center mb-2">
                     <p class="text-sm font-semibold text-indigo-500 dark:text-indigo-400">Question <span id="question-number"></span> of <span id="total-questions"></span></p>
                     <p class="text-sm font-semibold text-gray-600 dark:text-gray-300">Score: <span id="score">0</span></p>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-indigo-600 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
            </div>
            
            <h3 id="question-text" class="text-xl md:text-2xl font-semibold mb-6 min-h-[6rem]"></h3>
            
            <div id="options-container" class="space-y-3"></div>
            
            <div id="feedback-container" class="mt-6 p-4 rounded-lg hidden">
                <p id="feedback-text" class="font-semibold"></p>
                <p id="explanation-text" class="text-sm mt-2"></p>
            </div>

            <button id="next-btn" class="w-full mt-6 bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 px-6 rounded-lg text-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-gray-400 dark:focus:ring-gray-700 hidden">
                Next Question
            </button>
        </div>

        <!-- Result Screen (Initially hidden) -->
        <div id="result-screen" class="text-center hidden">
            <h2 class="text-3xl md:text-4xl font-bold text-indigo-600 dark:text-indigo-400 mb-4">Quiz Complete!</h2>
            <p class="text-lg text-gray-700 dark:text-gray-200 mb-2">Your Final Score:</p>
            <p id="final-score" class="text-5xl font-extrabold text-gray-900 dark:text-white mb-6"></p>
            <p id="result-message" class="text-gray-600 dark:text-gray-300 mb-8"></p>
            <button id="restart-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-indigo-300 dark:focus:ring-indigo-800">
                Try Same Chapter Again
            </button>
            <button id="back-to-main-menu-btn" class="w-full mt-4 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition-transform transform hover:scale-105">
                Choose Another Chapter
            </button>
        </div>
    </div>

    <script>
        const allQuizzes = {
            "chapter1": {
                title: "Chapter 1: The Essentials",
                questions: [
                    { topic: "Topic 1: Definition & Process", type: "mcq", question: "Strategic management is defined as the art and science of formulating, implementing, and ____ cross-functional decisions.", options: ["analyzing", "evaluating", "financing", "marketing"], answer: "evaluating", explanation: "The three core stages of strategic management are formulation, implementation, and evaluation." },
                    { topic: "Topic 1: Definition & Process", type: "tf", question: "The strategy-implementation stage is often considered the most difficult stage in strategic management.", answer: "True", explanation: "Strategy implementation requires personal discipline, commitment, and sacrifice from all employees and managers, making it a complex and challenging stage." },
                    { topic: "Topic 2: Key Concepts", type: "mcq", question: "Which term refers to what an organization does especially well compared to rival firms?", options: ["Competitive Advantage", "Long-term Objective", "Annual Objective", "Policy"], answer: "Competitive Advantage", explanation: "Sustaining a competitive advantage is the ultimate goal of strategic management." },
                    { topic: "Topic 2: Key Concepts", type: "mcq", question: "A company's 'vision statement' should answer which fundamental question?", options: ["'What is our business?'", "'Who are our customers?'", "'What do we want to become?'", "'What are our values?'"], answer: "'What do we want to become?'", explanation: "A vision statement is a long-term view of what the organization aspires to be." },
                    { topic: "Topic 3: Benefits & Importance", type: "mcq", question: "The primary benefit of strategic management is that it allows an organization to be more ____ than ____.", options: ["reactive; proactive", "profitable; non-profitable", "proactive; reactive", "centralized; decentralized"], answer: "proactive; reactive", explanation: "Strategic management enables a firm to initiate and influence activities, rather than just responding to them." },
                    { topic: "Topic 3: Benefits & Importance", type: "tf", question: "Financial benefits are the only significant advantage of engaging in strategic management.", answer: "False", explanation: "In addition to financial benefits, strategic management offers significant nonfinancial benefits like enhanced awareness of threats, increased employee productivity, and a clearer understanding of performance-reward relationships." },
                ]
            },
            "chapter2": {
                title: "Chapter 2: The Context of Managing Strategically",
                questions: [
                    { topic: "Topic 1: Perspectives on Competitive Advantage", type: "mcq", question: "The Industrial Organization (I/O) view suggests that competitive advantage primarily comes from:", options: ["A company's unique internal resources", "Properly analyzing and reacting to the external environment", "Rapid, radical surprises in the marketplace", "A strong organizational culture"], answer: "Properly analyzing and reacting to the external environment", explanation: "The I/O view, developed by Michael Porter, advocates that external industry factors are more important than internal factors in achieving competitive advantage." },
                    { topic: "Topic 1: Perspectives on Competitive Advantage", type: "tf", question: "The Resource-Based View (RBV) argues that external factors are more important than internal resources for achieving competitive advantage.", answer: "False", explanation: "The RBV argues the opposite: that internal resources are more important than external factors for achieving and sustaining competitive advantage." },
                ]
            },
            "chapter3": {
                title: "Chapter 3: Types of Strategies",
                questions: [
                    { topic: "Topic 1: Objectives", type: "mcq", question: "Increasing market share by 10% in the next fiscal year is an example of a ____ objective.", options: ["Financial", "Strategic", "Extrapolation", "Subjective"], answer: "Strategic", explanation: "Strategic objectives relate to a firm's competitive position and include things like market share, quality, and technological leadership." },
                    { topic: "Topic 2: Levels & Types of Strategies", type: "tf", question: "A combination strategy should always be pursued by all organizations.", answer: "False", explanation: "While some organizations employ a combination strategy, it can be exceptionally risky if carried too far, as resources and talents can get spread too thin." },
                ]
            },
            "chapter4": {
                title: "Chapter 4: Vision & Mission Analysis",
                questions: [
                    { topic: "Topic 1: Vision Statements", type: "mcq", question: "A vision statement should answer the basic question:", options: ["'What is our business?'", "'Who are our competitors?'", "'What do we want to become?'", "'How will we achieve our goals?'"], answer: "'What do we want to become?'", explanation: "A vision statement is a future-oriented declaration of the organization's purpose and aspirations." },
                    { topic: "Topic 4: Components of a Mission Statement", type: "tf", question: "A mission statement should always include specific monetary amounts, numbers, and percentages.", answer: "False", explanation: "A good mission statement is broad in scope and does NOT include monetary amounts, numbers, percentages, ratios, or objectives." },
                ]
            },
            "chapter5": {
                title: "Chapter 5: The Internal Audit",
                questions: [
                    { topic: "Topic 1: Nature of the Internal Audit", type: "mcq", question: "The primary purpose of an internal audit is to identify and evaluate a firm's:", options: ["External opportunities and threats", "Financial objectives only", "Internal strengths and weaknesses", "Competitors' strategies"], answer: "Internal strengths and weaknesses", explanation: "The internal audit is a thorough examination of a firm's internal functional areas to identify key strengths and weaknesses." },
                    { topic: "Topic 9: The IFE Matrix", type: "tf", question: "A total weighted score of 1.8 in an IFE Matrix indicates a strong internal position.", answer: "False", explanation: "The average score is 2.5. A score well below 2.5, like 1.8, characterizes an organization that is weak internally." },
                ]
            },
             "chapter6": {
                title: "Chapter 6: The External Audit",
                questions: [
                    { topic: "Topic 1: Nature of External Audit", type: "mcq", question: "The primary purpose of an external audit is to develop a finite list of:", options: ["Internal strengths and weaknesses", "Every possible factor that could influence the business", "Opportunities that could benefit a firm and threats that should be avoided", "The company's financial objectives"], answer: "Opportunities that could benefit a firm and threats that should be avoided", explanation: "An external audit aims to identify a well-defined list of opportunities and threats to inform strategy formulation." },
                    { topic: "Topic 3: Porter's Five-Forces Model", type: "tf", question: "High barriers to entry increase the intensity of competitiveness among firms.", answer: "False", explanation: "High barriers to entry make it difficult for new firms to enter an industry, which typically DECREASES the intensity of competitiveness for existing firms." },
                ]
            },
            "chapter8": {
                title: "Chapter 8: Strategy Generation & Selection",
                questions: [
                    { topic: "Topic 1: The Overall Framework", type: "mcq", question: "The strategy-formulation analytical framework consists of how many stages?", options: ["Two", "Three", "Four", "Five"], answer: "Three", explanation: "The framework has three stages: The Input Stage, The Matching Stage, and The Decision Stage." },
                    { topic: "Topic 4: The BCG Matrix", type: "tf", question: "In the BCG Matrix, 'Stars' typically have low market share.", answer: "False", explanation: "'Stars' are characterized by high market share in a high-growth industry." },
                ]
            }
        };

        // --- GLOBAL VARIABLES ---
        let currentQuestionIndex = 0;
        let score = 0;
        let activeQuizData = [];
        let currentChapterKey = '';

        // --- DOM ELEMENTS ---
        const chapterSelectionScreen = document.getElementById('chapter-selection-screen');
        const chapterButtonsContainer = document.getElementById('chapter-buttons-container');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');
        
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const backToChaptersBtn = document.getElementById('back-to-chapters-btn');
        const backToMainMenuBtn = document.getElementById('back-to-main-menu-btn');

        const topicTitleEl = document.getElementById('topic-title');
        const questionNumberEl = document.getElementById('question-number');
        const totalQuestionsEl = document.getElementById('total-questions');
        const scoreEl = document.getElementById('score');
        const progressBar = document.getElementById('progress-bar');
        
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const feedbackContainer = document.getElementById('feedback-container');
        const feedbackTextEl = document.getElementById('feedback-text');
        const explanationTextEl = document.getElementById('explanation-text');

        const finalScoreEl = document.getElementById('final-score');
        const resultMessageEl = document.getElementById('result-message');
        
        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', initializeApp);
        
        function initializeApp() {
            chapterButtonsContainer.innerHTML = '';
            const chapterOrder = ["chapter1", "chapter2", "chapter3", "chapter4", "chapter5", "chapter6", "chapter8"];
            
            chapterOrder.forEach(key => {
                if (allQuizzes[key]) {
                    const chapterInfo = allQuizzes[key];
                    const button = document.createElement('button');
                    button.classList.add('w-full', 'text-left', 'bg-white', 'dark:bg-gray-700', 'hover:bg-indigo-50', 'dark:hover:bg-gray-600', 'p-4', 'rounded-lg', 'text-lg', 'transition-all', 'duration-200', 'border', 'dark:border-gray-600', 'flex', 'items-center', 'space-x-4');
                    
                    const chapterNum = key.replace('chapter', '');
                    
                    button.innerHTML = `
                        <span class="flex-shrink-0 h-12 w-12 flex items-center justify-center bg-indigo-100 dark:bg-indigo-900/50 text-indigo-600 dark:text-indigo-300 font-bold text-xl rounded-full">${chapterNum}</span>
                        <span class="font-semibold text-gray-800 dark:text-gray-100">${chapterInfo.title.split(': ')[1]}</span>
                    `;
                    
                    button.onclick = () => selectChapter(key);
                    chapterButtonsContainer.appendChild(button);
                }
            });
            
            nextBtn.addEventListener('click', nextQuestion);
            restartBtn.addEventListener('click', () => startQuiz(currentChapterKey));
            backToChaptersBtn.addEventListener('click', showChapterSelection);
            backToMainMenuBtn.addEventListener('click', showChapterSelection);
        }

        function showChapterSelection() {
            quizScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            chapterSelectionScreen.classList.remove('hidden');
        }

        function selectChapter(chapterKey) {
            currentChapterKey = chapterKey;
            startQuiz(chapterKey);
        }

        function startQuiz(chapterKey) {
            activeQuizData = allQuizzes[chapterKey].questions;
            currentQuestionIndex = 0;
            score = 0;
            
            chapterSelectionScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            
            loadQuestion();
        }

        function loadQuestion() {
            optionsContainer.innerHTML = '';
            feedbackContainer.classList.add('hidden');
            nextBtn.classList.remove('hidden'); // Make Next button visible immediately

            const currentQuestion = activeQuizData[currentQuestionIndex];
            
            topicTitleEl.innerText = currentQuestion.topic;
            questionNumberEl.innerText = currentQuestionIndex + 1;
            totalQuestionsEl.innerText = activeQuizData.length;
            scoreEl.innerText = score;
            progressBar.style.width = `${((currentQuestionIndex) / activeQuizData.length) * 100}%`;
            
            questionTextEl.innerText = currentQuestion.question;

            let options;
            if (currentQuestion.type === 'tf') {
                options = ['True', 'False'];
            } else { 
                options = currentQuestion.options;
            }

            options.forEach(option => {
                const button = document.createElement('button');
                button.innerText = option;
                button.classList.add('w-full', 'text-left', 'p-4', 'rounded-lg', 'border', 'border-gray-300', 'dark:border-gray-600', 'bg-white', 'dark:bg-gray-700', 'hover:bg-gray-200', 'dark:hover:bg-gray-600', 'transition-colors', 'duration-200');
                button.onclick = () => selectAnswer(option, button);
                optionsContainer.appendChild(button);
            });

            if (currentQuestionIndex === activeQuizData.length - 1) {
                nextBtn.innerText = 'Show Results';
            } else {
                nextBtn.innerText = 'Next Question';
            }
        }

        function selectAnswer(selectedOption, button) {
            const currentQuestion = activeQuizData[currentQuestionIndex];
            const isCorrect = selectedOption === currentQuestion.answer;

            Array.from(optionsContainer.children).forEach(btn => {
                btn.disabled = true;
                const isCorrectAnswer = btn.innerText === currentQuestion.answer;
                
                if (isCorrectAnswer) {
                    btn.classList.remove('hover:bg-gray-200', 'dark:hover:bg-gray-600');
                    btn.classList.add('bg-green-100', 'dark:bg-green-800', 'border-green-500', 'dark:border-green-600', 'ring-2', 'ring-green-500');
                } else if(btn === button){
                    btn.classList.remove('hover:bg-gray-200', 'dark:hover:bg-gray-600');
                    btn.classList.add('bg-red-100', 'dark:bg-red-800', 'border-red-500', 'dark:border-red-600', 'ring-2', 'ring-red-500');
                }
            });

            feedbackContainer.classList.remove('hidden');
            if (isCorrect) {
                score++;
                feedbackTextEl.innerText = "Correct!";
                feedbackContainer.classList.remove('bg-red-100', 'dark:bg-red-900');
                feedbackContainer.classList.add('bg-green-100', 'dark:bg-green-900', 'text-green-800', 'dark:text-green-200');
            } else {
                feedbackTextEl.innerText = "Incorrect!";
                feedbackContainer.classList.remove('bg-green-100', 'dark:bg-green-900');
                feedbackContainer.classList.add('bg-red-100', 'dark:bg-red-900', 'text-red-800', 'dark:text-red-200');
            }
            explanationTextEl.innerText = currentQuestion.explanation;
            
            scoreEl.innerText = score;
        }

        function nextQuestion() {
             // If no answer has been selected, show the explanation for the correct answer
            if (!feedbackContainer.classList.contains('hidden')) {
                // do nothing, already answered
            } else {
                 const currentQuestion = activeQuizData[currentQuestionIndex];
                 Array.from(optionsContainer.children).forEach(btn => {
                    btn.disabled = true;
                    if(btn.innerText === currentQuestion.answer){
                        btn.classList.add('bg-blue-100', 'dark:bg-blue-800', 'border-blue-500', 'dark:border-blue-600');
                    }
                 });
                 feedbackTextEl.innerText = "Skipped";
                 explanationTextEl.innerText = `The correct answer is: ${currentQuestion.answer}. ${currentQuestion.explanation}`;
                 feedbackContainer.classList.remove('hidden');
                 feedbackContainer.classList.add('bg-gray-100', 'dark:bg-gray-900', 'text-gray-800', 'dark:text-gray-200');
                 setTimeout(goToNext, 2000); // Add a delay to show the skipped answer
                 return;
            }
            goToNext();
        }

        function goToNext(){
             if (currentQuestionIndex < activeQuizData.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            quizScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            progressBar.style.width = '100%';

            const percentage = Math.round((score / activeQuizData.length) * 100);
            finalScoreEl.innerText = `${score} / ${activeQuizData.length} (${percentage}%)`;

            let message = '';
            if (percentage === 100) {
                message = "Perfect Score! You're a master of this chapter's concepts!";
            } else if (percentage >= 80) {
                message = "Excellent job! You have a strong grasp of these topics.";
            } else if (percentage >= 60) {
                message = "Good effort! A little more review will make you an expert.";
            } else {
                message = "Keep studying! Review the explanations to improve your score.";
            }
            resultMessageEl.innerText = message;
        }
    </script>
</body>
</html>
